# I/O Hardware
## I/O Hardware
- Variety of I/O device
	- Storage
		- HDDã€SSD
	- Transmission
		- internet interface
	- Human-interface
		- keyboard
- ***Common concept***
	- **Port**
		- connection point for device
		- ex: thunderboltã€usb portã€SATAã€HDMI...
	- **Bus**
		- A set of *wire* and define *protocol*
		- Can be *daisy chain* ã€p2pã€or hub(1-å¤š) 
			- *daisy chain*:é€šå¸¸æ˜¯æŒ‡å°‡å¤šå€‹è£ç½®ä¾åºä¸²æ¥åœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€å€‹éˆç‹€çµæ§‹ã€‚
				- ![[Pasted image 20241008223914.png|example]]
		- PCIe bus(system bus)ã€expansion bus(I/O bus)
			- ![[Pasted image 20241008224625.png|example]]
	- **Device Controller**
		- A collection of ***electronics***  and can operate a port ,a bus or a device
			- é›»å­è¨­å‚™çš„é›†åˆï¼Œå¯æ“ä½œé€£æ¥åŸ ã€åŒ¯æµæ’æˆ–è¨­å‚™
		- ![[Pasted image 20241008225941.png]]
### Internal Structure of a  Device
- Simple: have a few or one hardware chips
	- keyboard
- Complex: include CPU,memory,some device-specific chip(å¯ä»¥åŸ·è¡Œä¸€äº›è»Ÿé«”)
	- frimware running on CPU
	- SSD controller,ç„¡ç·šç¶²è·¯æ™¶ç‰‡
![[Pasted image 20241008231602.png]]
### Hardware Interface
> [!question] How to give commands and data to controller ?
> - by register

![[Pasted image 20241008231802.png]]
## A Simplified I/O Hardware

![[Pasted image 20241009092917.png]]
![[Pasted image 20241009092904.png]]
![[Pasted image 20241009093734.png]]
![[Pasted image 20241009095122.png]]
- polling -> busy waiting
- programmed i/o(pio/cpu io)
	- ä½¿ç”¨ cpu transfer data (æ²’æ•ˆç‡cpu)
	- æ­£å¸¸è€Œè¨€ä½¿ç”¨ DMA æ•ˆç‡æ›´é«˜
### sol for polling
![[Pasted image 20241009101302.png]]
![[12.OS 2024-10-09 10.16.39.excalidraw]]
### sol for programmed i/o [[DMA]]
![[Pasted image 20241009102145.png]]
![[Pasted image 20241009102634.png]]
 
## Method of Device Interaction
> [!question] How to communicate with devicesï¼Ÿ
> ï¼ how to read/write these device registersï¼Ÿ

> [!sol] **solï¼š** assign each device reg a num,id or address

> [!question] address å¦‚ä½•æ±ºå®šï¼Ÿ

![[Pasted image 20241009104617.png]]
- Port-mapped(isolated i/o)
![[Pasted image 20241009105205.png]]
- memory mapp
![[Pasted image 20241009133706.png]]
![[Pasted image 20241009133717.png]]
## Polling
- **busy waiting** or **polling**
	- å¤§éƒ¨ä»½æƒ…æ³ä¸‹çš† *ä¸ ok*
- if ä¸ä½¿ç”¨ polling, ä½¿ç”¨ interrupt è™•ç† 
	- ç”± device *notify* CPU
- **å¿™ç¢Œç­‰å¾…ï¼ˆBusy-waitï¼‰é©åˆçš„ç’°å¢ƒ**ï¼šåœ¨é«˜ååé‡çš„ç³»çµ±ä¸­ï¼ŒI/O å¯èƒ½éå¸¸é »ç¹ï¼Œä¸”è™•ç†å™¨ç„¡æ³•æ‰¿å—å› è™•ç†ä¸­æ–·é€ æˆçš„æ€§èƒ½é–‹éŠ·ã€‚Polling åœ¨é€™ç¨®æƒ…æ³ä¸‹å¯ä»¥é¿å… interrupt å¼•ç™¼çš„ overhead ã€‚
## Interrupt
- How CPU knows an interrupt occurs ?
	-  CPU has a wire called ***interrupt-request line***
	- if it is set to 1 , CPU senses interrupt.
![[Pasted image 20241009211639.png]]
![[Pasted image 20241009212658.png]]

> [!bug] ***BUT*** Interrupt is not free!!
> interrupt has overhead,ä¸¦ä¸”æœ‰å¯èƒ½è¶…éä¹‹å‰çš„å¥½è™•
>![[Pasted image 20241009213148.png]]
>![[Pasted image 20241011093115.png]]
>![[Pasted image 20241011093220.png]]

### FLIH(first level interrupt handler) ï¼† SLIH(second level interrupt handler)
- FLIH 
	- å¿…é ˆè¢«ç«‹å³åŸ·è¡Œ,ç•¶ interrupt ç™¼ç”Ÿ
- SLIH 
	- SLIH æ˜¯ç”± FLIH è§¸ç™¼æˆ–èª¿ç”¨çš„æ¬¡ç´šä¸­æ–·è™•ç†ç¨‹åºï¼Œè² è²¬è™•ç†æ›´å¤šç´°ç¯€å’Œè¤‡é›œçš„å·¥ä½œã€‚
	- **ä¸»è¦åŠŸèƒ½**ï¼šå®ƒé€šå¸¸è² è²¬å®Œæˆ FLIH ä¾†ä¸åŠè™•ç†çš„è€—æ™‚æ“ä½œï¼Œä¾‹å¦‚æ•¸æ“šç·©å­˜ã€è³‡æ–™å‚³è¼¸æˆ–è€…èˆ‡é©…å‹•ç¨‹å¼å’Œæ‡‰ç”¨ç¨‹å¼çš„æºé€šã€‚
	- **é‹è¡Œé€Ÿåº¦**ï¼šç›¸è¼ƒæ–¼ FLIHï¼ŒSLIH å¯ä»¥é‹è¡Œå¾—ç¨æ…¢ä¸€äº›ï¼Œå› ç‚ºå®ƒä¸éœ€è¦ç«‹å³å›æ‡‰ä¸­æ–·ä¿¡è™Ÿï¼Œè€Œæ˜¯å®Œæˆå¾ŒçºŒçš„è™•ç†ã€‚
	- **ç‰¹æ€§**ï¼šSLIH å¯ä»¥è™•ç†è¼ƒå¤šçš„èƒŒæ™¯å·¥ä½œï¼Œåƒæ˜¯æ›´æ–°å…§éƒ¨ç‹€æ…‹ã€å•Ÿå‹•è£ç½®é©…å‹•ç¨‹å¼ã€æˆ–è€…ç‚ºæ‡‰ç”¨ç¨‹å¼æº–å‚™è³‡æ–™ç­‰ã€‚
- in Linux
	- FLIH is called upper half
	- SLIH is called lower half or bottom half

### trap & innterrupt [[1.OS]]
- interrupt
	- è™•ç† asynchronous(éåŒæ­¥) çš„ event
- trap(Exception)
	- è™•ç† synchronous(åŒæ­¥) çš„ event
	- system call & error

## Direct Memory Acess[[DMA]]
# Application I/O interface
## intro

![[Pasted image 20241017163350.png]]
- å¦‚ä½•æ±ºå®š system call for vary device(ä¾é ä»¥ä¸‹dimensions)
	- **Charater**-**stream** or **block**
		- Charater-stream : é€£çºŒå‚³é€ like dht11
		- block : ç•¶éœ€è¦æ™‚ä½¿ç”¨ block ä½œç‚ºå‚³è¼¸å–®ä½ like disk
	- **Sequential access** or **random** access
		- disk vs ssd
	- **sharable** or **dedicated(ä¸èƒ½å…±äº«çš„)**
	- **Speed** or **operation**
	- **R.W.** or **R** or **W** (read,write)
![[Pasted image 20241017165043.png]]
- i/o device å¯ä»¥åˆ†æˆå››é¡,å°æ–¼ä¸åŒ device ä½¿ç”¨ä¸åŒ system call
	- Block i/o
	- Charater-stream i/o
	- Clock and timer
	- Network sockets
	- other ,(back door/escape)
		- å°æ–¼ä¸€äº›ç‰¹æ®Šçš„ device (åŠŸèƒ½),os ä½¿ç”¨ç‰¹æ®Šæ–¹æ³•
		- ![[Pasted image 20241017165251.png]]
## Block device
### File-System System Call Interface
> [!example]
> - HDD
> - SSD

- Command include **read** **write** **seek**
![[Pasted image 20241023094206.png]]
 - Block device access indirectly(é–“æ¥) via **file**
	 - **file system interface**
		 - read write (system call)
		 - fread fwrite (libary â†’system call)
	 - **memory-mapped file**
		 - å°‡ data map åˆ°è¨˜æ†¶é«”å…§ (demand paging vitural memory)
		 - æ‰€ä»¥å¯ä»¥ç›´æ¥é€é memory å­˜å– HDD
		 - ![[Pasted image 20241023113631.png]]
		 - å„ªé»
			 - convenient
 - file access way
	 - File base i/o (ä½¿ç”¨ File system çš„ I/O)
		 - Buffered i/o
			 - access data go through **page cache** (éƒ½æœƒç¶“é page cache)
				 - page cacahe å¯ä»¥ç”¨æ–¼ prefetch (é æ¸¬éœ€è¦çš„fileä¸¦å–å‡º)
			 - ![[Pasted image 20241023102755.png]]
			 - ä¹Ÿå¯é€šéå…ˆå°‡ data æ”¾åˆ° page cache å†å¯«å…¥ HDD 
				 - æ”¾åˆ° page cache å° process è€Œè¨€å°±ç®—å®Œæˆå¯«å…¥
		 - Direct i/o 
			 - ä¸ä½¿ç”¨ Page cache ç›´æ¥ä½¿ç”¨ HDD å„²å­˜ File
	 - block base i/o(Logical Block Number)
		 - Raw i/o 
			 - accesss an array of **logical blocks**(ç›´æ¥ä½¿ç”¨ Block è€Œä¸æ˜¯ File )
			 - bypass all OS service
			 - disallow application(ä¸å…è¨±User modeåšé€™ç¨®äº‹) 
### C Standard Library Interface
#### Buffering in stdio Library
â€¢Four cases
- read a file character by character
- write a file character by character
- read a file block by block
- write a file block by block
##### case 1 read a file character by character
- Use C stdio library
	- ä½œæ¥­ç³»çµ±æœƒå¾å„²å­˜è£ç½®ï¼ˆå¦‚ç¡¬ç¢Ÿï¼‰**è®€å–ä¸€æ•´å¡Šè³‡æ–™åˆ° page cache**ï¼ˆé é¢å¿«å–ï¼‰ã€‚
	- æ¥è‘—æŠŠè³‡æ–™å†è¤‡è£½åˆ° **C å‡½å¼åº«çš„ bufferï¼ˆé€šå¸¸æ˜¯ FILE çµæ§‹å…§éƒ¨ bufferï¼‰**
	- ä¹‹å¾Œæ¯æ¬¡å‘¼å« `fgetc()`,è³‡æ–™æœƒå¾ C çš„å‡½å¼åº« buffer å‚³åˆ°ä½ çš„ç¨‹å¼è®Šæ•¸ä¸­ï¼Œé€™äº›å‹•ä½œ**åªæ¶‰åŠä¸€èˆ¬å‡½å¼å‘¼å«ï¼ˆprocedure callï¼‰**ï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½åšç³»çµ±å‘¼å«ï¼ˆsystem callï¼‰ã€‚
##### case 2 write a file character by character
- use  `fwrite`
	- å°‡ data å¯«å…¥ C libary buffer å°±ç®—å®Œæˆ (åªæœ‰ lib call âŒ sys call)
- use `write` (sys call)
	- â€¢Copy data from **program buffer** to the kernel **page cache**
##### case 3 read a file block by block
- use `fread`
```mermaid
graph LR
    A[Disk ç¡¬ç¢Ÿå„²å­˜] --> B[Page Cache æ ¸å¿ƒå¿«å–]
    B --> C[Library Buffer C å‡½å¼åº«å¿«å–å€]
    C --> D[Program Buffer ç¨‹å¼çš„è®Šæ•¸ç©ºé–“]
```
- use `read`
```mermaid
graph LR
    A[Disk ç¡¬ç¢Ÿå„²å­˜] --> B[Page Cache æ ¸å¿ƒå¿«å–]
    B --> D[Program Buffer ç¨‹å¼çš„è®Šæ•¸ç©ºé–“]
```
- Time of Command
	- T(3 copy) > T(2 copy) 
	- T(2 copy+lib call) > T(1 copy + sys call)
	- T(`fread`)>T(`read`)
##### Case 4: write a file block by block

### Buffered I/O, Direct I/O, and RAW I/O

### Memory-mapped Files

### Charater Devices
- Include keyboards, mice, serial ports
- basic sys calll:
		![[Pasted image 20250410214558.png]]
- æ¨™æº–å‡½å¼åº«ï¼ˆåƒæ˜¯ C çš„ stdio.hï¼‰æœƒåœ¨ç³»çµ±å‘¼å«ä¸ŠåŠ ä¸€å±¤ã€Œç·©è¡å€ï¼ˆbufferingï¼‰ã€èˆ‡ã€Œç·¨è¼¯æ”¯æ´ã€ï¼Œä¾‹å¦‚ï¼š
	- ä¸€è¡Œè¡Œåœ°ç·©è¡è¼¸å…¥è³‡æ–™ï¼ˆLine Bufferingï¼‰
	- è™•ç†ç‰¹æ®ŠæŒ‰éµï¼Œåƒæ˜¯ï¼š
	    - **Backspace**ï¼šä½¿ç”¨è€…æŒ‰é€€æ ¼éµæ™‚ï¼Œå¯¦éš›ä¸Šæœƒç§»é™¤å‰ä¸€å€‹è¼¸å…¥å­—å…ƒ
	    - **Enter**ï¼šæŒ‰ä¸‹å¾Œæ‰é€å‡ºæ•´è¡Œè³‡æ–™çµ¦ç¨‹å¼ä½¿ç”¨
	- é€™äº›åŠŸèƒ½**ç³»çµ±å‘¼å«æœ¬èº«æ˜¯æ²’æœ‰çš„**ï¼Œä½†å‡½å¼åº«æœƒå¹«ä½ åšåˆ°ï¼Œè®“ç¨‹å¼æ›´å¥½å¯«ã€ä¹Ÿæ›´å‹å–„ã€‚
![[Pasted image 20250410214910.png]]

### Nonblocking and Asynchronous I/O
- Block & non-Block
	- Block : æŒ‡çš„æ˜¯ if the program need some data but it didn't release ,the following program will be block 
	-  non-Block: ç›¸å
- Asynchronous
	- éåŒæ­¥ I/Oï¼ˆAsynchronous I/Oï¼‰
		- ç¨‹å¼å‘¼å« I/O å¾Œï¼Œ**ä¸ç­‰å®ƒå®Œæˆå°±é¦¬ä¸Šç¹¼çºŒåšå…¶ä»–äº‹æƒ…**ï¼Œç­‰ä½œæ¥­ç³»çµ±æˆ–è£ç½®å®Œæˆ I/O å¾Œï¼Œå†é€éã€Œé€šçŸ¥æ©Ÿåˆ¶ã€å‘Šè¨´ç¨‹å¼ã€‚
	- åŒæ­¥ I/Oï¼ˆSynchronous I/Oï¼‰
		- ç¨‹å¼åœ¨å‘¼å« I/O æ“ä½œæ™‚ï¼Œ**æœƒç­‰å¾…æ“ä½œå®Œæˆå¾Œï¼Œæ‰ç¹¼çºŒåŸ·è¡Œå¾Œé¢çš„ç¨‹å¼ç¢¼**ã€‚
		- -**é˜»å¡å¼ï¼ˆBlockingï¼‰**ï¼šå®Œå…¨å¡ä½ï¼Œç›´åˆ° I/O å®Œæˆã€‚
		- **éé˜»å¡å¼ï¼ˆNonblockingï¼‰**ï¼šä¸»ç¨‹å¼ä¸æœƒå¡ä½ï¼Œä½†é‚„æ˜¯**ä¸»å‹•å»æª¢æŸ¥** I/O æ˜¯å¦å®Œæˆã€‚

| é¡å‹                           | æ˜¯å¦åŒæ­¥  | æ˜¯å¦é˜»å¡  | ç‰¹æ€§èˆ‡èªªæ˜                                                                                             |
| ---------------------------- | ----- | ----- | ------------------------------------------------------------------------------------------------- |
| â‘  Synchronous + Blocking     | âœ… åŒæ­¥  | âœ… é˜»å¡  | å‘¼å«åƒ `read()` æˆ– `write()`ï¼Œç¨‹å¼æœƒ**åœä½ç­‰è³‡æ–™å®Œæˆ**æ‰ç¹¼çºŒã€‚ç°¡å–®ä½†æ•ˆèƒ½å·®ã€‚                                                |
| â‘¡ Synchronous + Nonblocking  | âœ… åŒæ­¥  | âŒ éé˜»å¡ | å‘¼å« `read()` / `write()` åŠ ä¸Š `O_NONBLOCK`ï¼Œå¦‚æœè³‡æ–™æ²’æº–å‚™å¥½æœƒé¦¬ä¸Šå›å‚³ï¼ˆå¯èƒ½å›å‚³ 0 æˆ–éŒ¯èª¤ï¼‰ã€‚ç¨‹å¼**è‡ªå·±è¦è¼ªè©¢è³‡æ–™ç‹€æ…‹**ã€‚                |
| â‘¢ Asynchronous + Blocking    | âŒ éåŒæ­¥ | âœ… é˜»å¡  | ä½¿ç”¨ `aio_read()` / `aio_write()` ç™¼å‡º I/O è«‹æ±‚ï¼Œä½†ä¹‹å¾Œå¯èƒ½ä½¿ç”¨ `aio_suspend()` ä¾†ç­‰å¾…å®Œæˆï¼ˆç¨‹å¼æœƒè¢«æš«åœï¼Œä½†éç«‹å³æ“ä½œï¼‰ã€‚           |
| â‘£ Asynchronous + Nonblocking | âŒ éåŒæ­¥ | âŒ éé˜»å¡ | ä½¿ç”¨ `aio_read()` / `aio_write()` ç™¼å‡ºè«‹æ±‚å¾Œï¼Œç¨‹å¼é¦¬ä¸Šç¹¼çºŒåŸ·è¡Œå…¶ä»–è¨ˆç®—ï¼Œä¹‹å¾Œé€é callbackã€signalã€poll ç­‰æ©Ÿåˆ¶è™•ç†å®Œæˆäº‹ä»¶ã€‚æœ€æœ‰æ•ˆç‡ï¼Œä½†æœ€é›£å¯«ã€‚ |

### Vectored I/O
Vector I/O æŒ‡çš„æ˜¯ä¸€æ¬¡æ€§åœ°è®€å–æˆ–å¯«å…¥**å¤šå€‹è³‡æ–™å€å¡Šï¼ˆbufferï¼‰**ï¼Œæ¯”èµ·å‚³çµ±çš„ `read()` / `write()` æ¯æ¬¡è™•ç†ä¸€å€‹ buffer vector I/O å¯ä»¥ç”¨ä¸€å€‹ç³»çµ±å‘¼å«è™•ç†å¤šå€‹å€å¡Šã€‚
é€™ç¨®æ–¹å¼ç¨±ç‚ºï¼š
- **Scatter/Gather I/O**
#### ğŸ”¸Vector I/O æ˜¯ã€Œä½œæ¥­ç³»çµ±å±¤ç´šã€çš„æŠ€è¡“
- **ç”±ç¨‹å¼è¨­è¨ˆå¸«ä¸»å‹•å‘¼å«**ï¼ˆå¦‚ï¼š`readv()` / `writev()`ï¼‰
- ç›®çš„ï¼šè®“å¤šå€‹ buffer ä¸€æ¬¡æ€§å‚³çµ¦ OSï¼Œ**æ¸›å°‘ç³»çµ±å‘¼å«é–‹éŠ·**ï¼Œæå‡æ•ˆèƒ½
- ä¸»è¦ç™¼ç”Ÿåœ¨ï¼š**ä½¿ç”¨è€…ç©ºé–“ â‡„ OS kernel ç©ºé–“**
    

---

#### ğŸ”¸ Scatter/Gather DMA æ˜¯ã€Œç¡¬é«”å±¤ç´šã€çš„æŠ€è¡“

- ç”±ç¡¬é«”çš„ DMA æ§åˆ¶å™¨ï¼ˆDirect Memory Accessï¼‰ä¾†è™•ç†è³‡æ–™æ¬é‹
- å¯å¾è¨˜æ†¶é«”ä¸­**éé€£çºŒå€å¡Š**æ¬è³‡æ–™åˆ°è£ç½®ï¼Œæˆ–åä¹‹
- å¯æ¸›å°‘ CPU åƒèˆ‡ã€åŠ é€Ÿå¤§è³‡æ–™å‚³è¼¸
- ä¸»è¦ç™¼ç”Ÿåœ¨ï¼š**ä¸»è¨˜æ†¶é«” â‡„ I/O è£ç½®ï¼ˆåƒç£ç¢Ÿã€ç¶²å¡ï¼‰**
# Kernel I/O Subsystem 
- Improve performance
	- I/O Scheduling
	- Buffering
	- Caching
	- Spooling and Device Reservation
- Error handling
- Protection
- Power management
## I/O Scheduling (See [[11.OS]])

## Buffering
- **Buffering** - a memory area store data being transferred between devices
	- Ex: C library buffer or page cache
- Why
	- ç‚ºåŒ¹é…å…©å€‹ device çš„ **speed mismatch**
		- å…ˆæŠŠå¤§é‡è³‡æ–™æ”¾å…¥ buffer åœ¨ä¸€æ¬¡æ€§æ”¾å…¥ storage ä»¥æ¸›å°‘ i/o æ¬¡æ•¸
		- also use double buffer
	- ç‚ºåŒ¹é…å…©å€‹ device çš„ **data transfer size**
		- ä¾‹å¦‚ : A send B a large message with å°‘é‡å¤šæ¬¡, å°±å¯ä»¥åœ¨buffer é‡å»º msg
	- To maintain **Copy sematics**

```c
char buf[100] = "Hello, world!";
write(fd, buf, 13);
strcpy(buf, "HACKED!");
```
åœ¨ä»¥ä¸Š code ä¸­çš„æƒ…æ³ä¸­,**2** æ™‚è¦æŠŠ buf write into disk ,ä½†**3** æ™‚è¦ä¿®æ”¹ buf,ç‚ºäº†ä¸é€ æˆ data è¡çª(because code é‡æ’),è€Œå…ˆå°‡ buf å¯«å…¥ kernal buffer
## Caching
- **Caching** â€“ a region of fast memory holding copy of data
	- just a **COPY**
	- for performance

### Buffer V.S. Cache
##### âœ… Bufferï¼ˆç·©è¡å€ï¼‰

|é …ç›®|èªªæ˜|
|---|---|
|ğŸ“Œ å®šç¾©|æš«æ™‚å„²å­˜è³‡æ–™ç”¨çš„å€åŸŸï¼Œç”¨ä¾†**èª¿ç¯€è³‡æ–™æµå‹•é€Ÿåº¦ä¸ä¸€è‡´çš„å…©ç«¯**ï¼ˆä¾‹å¦‚ç¨‹å¼èˆ‡ç£ç¢Ÿï¼‰|
|ğŸ“ è³‡æ–™ä½ç½®|ç·©è¡å€å…§çš„è³‡æ–™**å¯èƒ½æ˜¯å”¯ä¸€çš„ copy**ï¼Œä¹Ÿå°±æ˜¯**ç›®å‰åªå­˜åœ¨é€™è£¡**|
|ğŸ¯ ç”¨é€”|å¸¸ç”¨æ–¼ **write() ä½œæ¥­æ™‚æš«å­˜è³‡æ–™**ï¼Œç›´åˆ°å¯¦éš›å¯«å…¥ç£ç¢Ÿ|
|ğŸ› ï¸ ç‰¹æ€§|å¯«è³‡æ–™å‰å…ˆé€²å…¥ bufferï¼Œç­‰è³‡æ–™å¤ å¤šæˆ– I/O ç©ºé–’æ™‚å†çœŸæ­£é€å‡º|

##### âœ… å¯¦éš›ä¾‹å­ï¼š
```
write() â†’ è³‡æ–™å…ˆæ”¾é€² write bufferï¼ˆç·©è¡å€ï¼‰           â†’ ç­‰ç­‰å†å¯«å…¥ç£ç¢Ÿ
```

---

##### âœ… Cacheï¼ˆå¿«å–ï¼‰

|é …ç›®|èªªæ˜|
|---|---|
|ğŸ“Œ å®šç¾©|ç”¨ä¾†**åŠ é€Ÿå­˜å–é »ç¹ä½¿ç”¨è³‡æ–™**çš„å€åŸŸï¼Œå­˜æ”¾çš„æ˜¯**åŸå§‹è³‡æ–™çš„å‰¯æœ¬**|
|ğŸ“ è³‡æ–™ä½ç½®|è³‡æ–™**åŸæœ¬å­˜åœ¨åˆ¥è™•**ï¼ˆä¾‹å¦‚ï¼šç£ç¢Ÿï¼‰ï¼Œcache åªæ˜¯**æš«æ™‚å­˜ä¸€ä»½åœ¨æ¯”è¼ƒå¿«çš„åœ°æ–¹ï¼ˆRAMï¼‰**|
|ğŸ¯ ç”¨é€”|å¸¸ç”¨æ–¼ **read() ä½œæ¥­æ™‚é¿å…é‡æ–°å­˜å–ç£ç¢Ÿ**|
|ğŸ› ï¸ ç‰¹æ€§|è‹¥è³‡æ–™å·²å­˜åœ¨å¿«å–ä¸­ï¼Œå¯çœå»ç£ç¢Ÿå­˜å–æ™‚é–“ï¼Œ**æ•ˆèƒ½æ›´å¥½**|

##### âœ… å¯¦éš›ä¾‹å­ï¼š

```
read() â†’ æª¢æŸ¥ page cache ä¸­æ˜¯å¦æœ‰è³‡æ–™ï¼ˆcache hitï¼‰        â†’ æœ‰çš„è©±ç›´æ¥å¾ cache è®€ï¼Œæ²’æœ‰å†å»ç£ç¢Ÿè®€ï¼ˆcache missï¼‰
```

## Spooling and Device Reservation
- Simultaneous Peripheral Operation On-Line
### âœ… å®šç¾©ï¼š
> **SPOOLING æ˜¯ä¸€ç¨®ä½œæ¥­ç³»çµ±æŠ€å·§ï¼Œç”¨ä¾†å°‡è³‡æ–™å…ˆå¯«å…¥ç£ç¢Ÿç­‰æš«å­˜åª’ä»‹ï¼Œç„¶å¾Œå†ç”±èƒŒæ™¯ç¨‹åºé€ä¸€é€çµ¦æ…¢é€Ÿçš„å‘¨é‚Šè¨­å‚™ï¼ˆåƒæ˜¯å°è¡¨æ©Ÿï¼‰ã€‚**

æ›å¥è©±èªªï¼Œå°±æ˜¯ï¼š
- ç¨‹å¼ä¸ç›´æ¥è·Ÿæ…¢é€Ÿçš„è£ç½®ï¼ˆåƒå°è¡¨æ©Ÿã€æ‰“å­”å¡æ©Ÿï¼‰æ‰“äº¤é“
- è€Œæ˜¯å…ˆã€Œä¸Ÿè³‡æ–™åˆ°ç£ç¢Ÿä¸Šçš„æš«å­˜æª”ã€
- ä¹‹å¾Œç”±èƒŒæ™¯è™•ç†ç¨‹å¼æ…¢æ…¢æŠŠå®ƒäº¤çµ¦è£ç½®åŸ·è¡Œ
## Error Handling(Skip)

## I/O Protection

## Kernel Data Structures (Skip)

## Power Management(Skip)
- Power management not only save power but also help reducing the heat
- OS can help power manage
	- Cloud environments move VM between servers
		- Migrating VMs from some computers and shutting these computers down
	- CPU cores can also be suspended when the load is low
- Mobile computing has power management as first class OS aspect
# Transforming I/O Requests to Hardware Operations
![[Pasted image 20250411045141.png]]

# Streams(Skip)

# Performance
![[Pasted image 20250411050029.png]]